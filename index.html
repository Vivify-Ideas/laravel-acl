<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Laravel ACL by Vivify-Ideas</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Laravel ACL</h1>
        <p>ACL component for Laravel 4</p>

        <p class="view"><a href="https://github.com/Vivify-Ideas/laravel-acl">View the Project on GitHub <small>Vivify-Ideas/laravel-acl</small></a></p>


        <ul>
          <li><a href="https://github.com/Vivify-Ideas/laravel-acl/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/Vivify-Ideas/laravel-acl/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/Vivify-Ideas/laravel-acl">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="laravel-acl" class="anchor" href="#laravel-acl"><span class="octicon octicon-link"></span></a>Laravel ACL</h1>

<p>ACL component for Laravel 4.</p>

<ul>
<li><a href="#installation">Installation</a></li>
<li>
<a href="#configuration">Configuration</a>

<ul>
<li><a href="#provider">Provider</a></li>
<li><a href="#superusers">Super users</a></li>
<li><a href="#guestuser">Guest user</a></li>
<li><a href="#permissions">Permissions</a></li>
<li><a href="#groups">Groups</a></li>
</ul>
</li>
<li><a href="#usage">Usage</a></li>
</ul><h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>First you need to install this package through Composer. Edit your project's <code>composer.json</code> file to require <code>vivify-ideas/acl</code>.</p>

<pre><code>  "require": {
    "vivify-ideas/acl": "dev-master"
  },
  "minimum-stability" : "dev"
</code></pre>

<p>Next, update Composer from the Terminal:</p>

<pre><code>  composer update
</code></pre>

<p>Once this operation completes, you will need to add the service provider into your app. Open <code>app/config/app.php</code>, and add a new item to the providers array.</p>

<pre><code>  'VivifyIdeas\Acl\AclServiceProvider
</code></pre>

<p>And also add new alias into aliases array.</p>

<pre><code>  'Acl' =&gt; 'VivifyIdeas\Acl\Facades\Acl',
</code></pre>

<p>Last step is to create main structure for keeping ACL. You can easy done this by running <code>artisan</code> command:</p>

<pre><code>php artisan acl:install
</code></pre>

<p>This will use current permission provider (<code>Eloquent</code>) and create DB structure for saving permissions. It will create 2 additional tables <code>acl_permissions</code> and <code>acl_user_permissions</code>.</p>

<p>That's it! You're all set to go.</p>

<h2>
<a name="configuration" class="anchor" href="#configuration"><span class="octicon octicon-link"></span></a>Configuration</h2>

<p>After runing <code>artisan acl:install</code> command, you will get a new config file in <code>app/config/packages/vivify-ideas/acl/config.php</code>.</p>

<p>There you will notice 5 sections.</p>

<h3>
<a name="provider" class="anchor" href="#provider"><span class="octicon octicon-link"></span></a>Provider</h3>

<div class="highlight"><pre><span class="s1">'provider'</span> <span class="o">=&gt;</span> <span class="s1">'eloquent'</span>
</pre></div>

<p>Main feature of this ACL component is <code>PermissionsProvider</code>. Permission provider represent class that handle permissions. Currently there is only one permission provider <code>Eloquent</code> (you can assume that permissions will be stored in DB that you specified on your project).</p>

<h3>
<a name="superusers" class="anchor" href="#superusers"><span class="octicon octicon-link"></span></a>SuperUsers</h3>

<div class="highlight"><pre><span class="s1">'superusers'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">()</span>
</pre></div>

<p>Here you can define user IDs that will have superuser rights. This users will be able allowed all permissions.</p>

<h3>
<a name="guestuser" class="anchor" href="#guestuser"><span class="octicon octicon-link"></span></a>GuestUser</h3>

<div class="highlight"><pre><span class="s1">'guestuser'</span> <span class="o">=&gt;</span> <span class="mi">0</span>
</pre></div>

<p>Put here ID that will used for setting permissions to guest users.</p>

<h3>
<a name="permissions" class="anchor" href="#permissions"><span class="octicon octicon-link"></span></a>Permissions</h3>

<div class="highlight"><pre><span class="s1">'permissions'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">()</span>
</pre></div>

<p>Here you need to put all permissions that exist in your system. Permissions need to be in next format</p>

<div class="highlight"><pre><span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span>
    <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'PERMISSION_ID'</span><span class="p">,</span>
    <span class="s1">'allowed'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="o">|</span><span class="k">false</span><span class="p">,</span>
    <span class="s1">'route'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="s1">'GET:/resource/(\d+)/edit'</span><span class="p">,</span> <span class="s1">'PUT:/resource/(\d+)'</span><span class="p">),</span>
    <span class="s1">'resource_id_required'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="o">|</span><span class="k">false</span><span class="p">,</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Permission name'</span><span class="p">,</span>
    <span class="s1">'group_id'</span> <span class="o">=&gt;</span> <span class="s1">'GROUP_ID_1'</span><span class="p">,</span> <span class="c1">// optional</span>
  <span class="p">),</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'PERMISSION_ID_2'</span><span class="p">,</span>
    <span class="s1">'allowed'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="o">|</span><span class="k">false</span><span class="p">,</span>
    <span class="s1">'route'</span> <span class="o">=&gt;</span> <span class="s1">'GET:/resource/(\d+)'</span><span class="p">,</span>
    <span class="s1">'resource_id_required'</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="o">|</span><span class="k">false</span><span class="p">,</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Permission 2 name'</span>
    <span class="s1">'group_id'</span> <span class="o">=&gt;</span> <span class="s1">'GROUP_ID_2'</span><span class="p">,</span> <span class="c1">// optional</span>
  <span class="p">)</span>
 <span class="p">)</span>
</pre></div>

<h3>
<a name="groups" class="anchor" href="#groups"><span class="octicon octicon-link"></span></a>Groups</h3>

<div class="highlight"><pre><span class="s1">'groups'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">()</span>
</pre></div>

<p>Every permission can belong to some group. You can have groups that belongs to other group. Every group can have a route. Use next format:</p>

<div class="highlight"><pre><span class="k">array</span><span class="p">(</span>
  <span class="k">array</span><span class="p">(</span>
    <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'ADMIN_PRIVILEGES'</span><span class="p">,</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Administrator Privileges'</span><span class="p">,</span>
    <span class="s1">'route'</span> <span class="o">=&gt;</span> <span class="s1">'GET:/admin/(\d+)'</span><span class="p">,</span>

    <span class="s1">'children'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
      <span class="k">array</span><span class="p">(</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'MANAGE_STUFF'</span><span class="p">,</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Manage Stuff'</span><span class="p">,</span>
        <span class="s1">'route'</span> <span class="o">=&gt;</span> <span class="s1">'GET:/resource/(\d+)'</span>
      <span class="p">),</span>
      <span class="k">array</span><span class="p">(</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'MANAGE_PRODUCTS'</span><span class="p">,</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Manage Products'</span><span class="p">,</span>
        <span class="s1">'route'</span> <span class="o">=&gt;</span> <span class="s1">'GET:/resource/(\d+)'</span>
      <span class="p">),</span>
      <span class="k">array</span><span class="p">(</span>
        <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'MANAGE_USERS'</span><span class="p">,</span>
        <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Manage Users'</span><span class="p">,</span>
        <span class="s1">'route'</span> <span class="o">=&gt;</span> <span class="s1">'GET:/resource/(\d+)'</span><span class="p">,</span>

        <span class="s1">'children'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
          <span class="k">array</span><span class="p">(</span>
            <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'MANAGE_SPEC_USER'</span><span class="p">,</span>
            <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Manage spec user'</span><span class="p">,</span>
            <span class="s1">'route'</span> <span class="o">=&gt;</span> <span class="s1">'GET:/resource/(\d+)'</span>
          <span class="p">)</span>
        <span class="p">)</span>
      <span class="p">)</span>
    <span class="p">)</span>
  <span class="p">),</span>
  <span class="k">array</span><span class="p">(</span>
    <span class="s1">'id'</span> <span class="o">=&gt;</span> <span class="s1">'STUFF_PRIVILEGES'</span><span class="p">,</span>
    <span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Stuff Privileges'</span><span class="p">,</span>
  <span class="p">)</span>
<span class="p">)</span>
</pre></div>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>When you are satisfy how your configuration file look like, run next artisan command:</p>

<pre><code>php artisan acl:update
</code></pre>

<p>This command you need to run every time when you update config file with new permissions.</p>

<p>If you want to delete all permissions (including user permissions), and again reload permissions from config file you can use this command:</p>

<pre><code>php artisan acl:reset
</code></pre>

<h3>
<a name="available-artisan-commands" class="anchor" href="#available-artisan-commands"><span class="octicon octicon-link"></span></a>Available Artisan commands</h3>

<p>Here is the list of all artisan commands:</p>

<ul>
<li>
<code>acl:install</code> Create basic ACL table structure.</li>
<li>
<code>acl:install clean</code> Delete all acl tables, reset config file to default version and again create basic ACL table structure.</li>
<li>
<code>acl:update</code> Update all ACL permissions from config file.</li>
<li>
<code>acl:reset</code> Reset all ACL permissions. This will delete both user and system permissions and install permissions from config file</li>
</ul><h3>
<a name="checking-permissions" class="anchor" href="#checking-permissions"><span class="octicon octicon-link"></span></a>Checking permissions</h3>

<p>Here are few ways how to check user permissions:</p>

<div class="highlight"><pre><span class="c1">// Whether a user with ID 2 can see a list of all products</span>
<span class="nx">Acl</span><span class="o">::</span><span class="na">user</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">permission</span><span class="p">(</span><span class="s1">'LIST_PRODUCTS'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">();</span>

<span class="c1">// Whether a user with ID 1 can edit product with ID 2</span>
<span class="nx">Acl</span><span class="o">::</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">permission</span><span class="p">(</span><span class="s1">'EDIT_PRODUCT'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">();</span>

<span class="c1">// Can currently authenticated user edit product with ID 2</span>
<span class="nx">Acl</span><span class="o">::</span><span class="na">permission</span><span class="p">(</span><span class="s1">'EDIT_PRODUCT'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">();</span>

<span class="c1">// Whether a user with ID 1 can edit and delete product with ID 2</span>
<span class="nx">Acl</span><span class="o">::</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">permission</span><span class="p">(</span><span class="s1">'EDIT_PRODUCT'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">permission</span><span class="p">(</span><span class="s1">'DELETE_PRODUCT'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">check</span><span class="p">();</span>

<span class="c1">// Can user with ID 1 access /products URL</span>
<span class="nx">Acl</span><span class="o">::</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">checkRoute</span><span class="p">(</span><span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'/products'</span><span class="p">)</span>

<span class="c1">// Can currently authenticated user access /products URL</span>
<span class="nx">Acl</span><span class="o">::</span><span class="na">checkRoute</span><span class="p">(</span><span class="s1">'GET'</span><span class="p">,</span> <span class="s1">'/products'</span><span class="p">);</span>

<span class="c1">// Get me array of product IDs that user with ID 1 can edit</span>
<span class="nx">Acl</span><span class="o">::</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">permission</span><span class="p">(</span><span class="s1">'EDIT_PRODUCT'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getResourceIds</span><span class="p">();</span>

<span class="c1">// Get me array of product IDs that user with ID 1 can not edit</span>
<span class="nx">Acl</span><span class="o">::</span><span class="na">user</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">permission</span><span class="p">(</span><span class="s1">'EDIT_PRODUCT'</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getResourceIds</span><span class="p">(</span><span class="k">false</span><span class="p">);</span>
</pre></div>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/Vivify-Ideas">Vivify-Ideas</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>